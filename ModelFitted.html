<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Loïc Pages" />

<meta name="date" content="2025-02-11" />

<title>Models Fitted</title>

<script src="ModelFitted_files/header-attrs-2.29/header-attrs.js"></script>
<script src="ModelFitted_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="ModelFitted_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="ModelFitted_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="ModelFitted_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="ModelFitted_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="ModelFitted_files/navigation-1.1/tabsets.js"></script>
<link href="ModelFitted_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="ModelFitted_files/highlightjs-9.12.0/highlight.js"></script>
<link href="ModelFitted_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="ModelFitted_files/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Models Fitted</h1>
<h4 class="author">Loïc Pages</h4>
<h4 class="date">2025-02-11</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<pre class="r"><code>rm(list=ls())
library(knitr)
library(spaMM)</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;registry&#39;:
##   method               from 
##   print.registry_field proxy
##   print.registry_entry proxy</code></pre>
<pre><code>## spaMM (Rousset &amp; Ferdy, 2014, version 4.5.30) is loaded.
## Type &#39;help(spaMM)&#39; for a short introduction,
## &#39;news(package=&#39;spaMM&#39;)&#39; for news,
## and &#39;citation(&#39;spaMM&#39;)&#39; for proper citation.
## Further infos, slides, etc. at https://gitlab.mbb.univ-montp2.fr/francois/spamm-ref.</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre class="r"><code>library(splines)
library(patchwork)

setwd(&quot;/media/loic/Commun/0Travail/Stage 2025 ISEM/Models&quot;)

centauree_data &lt;- read.csv(&quot;donnesIPM_short.csv&quot;)
centauree_data_complet &lt;- read.csv(&quot;donnesIPM.csv&quot;)


#Supprimer plantes dont l&#39;age est inconnu
centauree_data &lt;- centauree_data[!is.na(centauree_data$age0), ]
centauree_data$age1 &lt;- ifelse(centauree_data$Stage1==&quot;V&quot;,centauree_data$age0+1,NA)

#Forcer l&#39;age maximal à 8
length(centauree_data$age0[centauree_data$age0 &gt;= 8])</code></pre>
<pre><code>## [1] 93</code></pre>
<pre class="r"><code>centauree_data$age0[centauree_data$age0 &gt; 8] &lt;- 8

spaMM.options(separation_max=70)</code></pre>
<pre class="r"><code>annees &lt;- 1995:2022
populations &lt;- c(&quot;Po&quot;,&quot;Au&quot;,&quot;Pe&quot;,&quot;E1&quot;,&quot;E2&quot;,&quot;Cr&quot;)
taille_range &lt;- seq(0.5, 20, by = 0.5) 
age_range &lt;- 1:8

fake_data &lt;- expand.grid(
  year = annees,
  Pop = populations,
  Size0Mars = taille_range,
  age0 = age_range
)

fake_data &lt;- fake_data %&gt;% 
  mutate(Nrw = row_number())</code></pre>
</div>
<div id="survival-probability" class="section level1">
<h1>Survival probability</h1>
<pre class="r"><code>survdata &lt;- centauree_data[centauree_data$Flowering0!=1,]
survdata &lt;- survdata[!is.na(survdata$Size1Mars),]


survdata %&gt;%
  group_by(Size0Mars) %&gt;%
  mutate(survivalProba = sum(SurvieMars, na.rm = TRUE) / n()) %&gt;% 
  ggplot(aes(x = Size0Mars, y = SurvieMars)) +
  geom_count(alpha = 0.6) +  # Points dimensionnés selon la fréquence
  geom_point(aes(y = survivalProba), color = &quot;red&quot;, size = 0.5) +
  geom_line(aes(y = survivalProba), color = &quot;red&quot;) +
  labs(title = &quot;Relation entre la taille et la survie&quot;,
    x = &quot;Taille&quot;,
    y = &quot;Survie&quot;) +
  ylim(0, 1) +
  theme_minimal()</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>survdata %&gt;%
  group_by(age0) %&gt;%
  mutate(survivalProba = sum(SurvieMars, na.rm = TRUE) / n()) %&gt;%
  ggplot(aes(x = age0, y = SurvieMars)) +
    geom_count(alpha = 0.6) +  # Points dimensionnés selon la fréquence
    geom_point(aes(x = age0, y = survivalProba), color = &quot;red&quot;, size = 1) +
    geom_line(aes(x = age0, y = survivalProba), color = &quot;red&quot;) +
    labs(title = &quot;Relation entre l&#39;age et la survie&quot;,
    x = &quot;age&quot;,
    y = &quot;Survie&quot;) +
  ylim(0, 1) +
  theme_minimal()</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code>Survglm1 &lt;- fitme(SurvieMars ~ 1+ bs(Size0Mars,df=5,degree=3) + bs(age0,degree=3,knots = 6.5)+ (Size0Mars|year) + (age0|Pop) ,
                 family=binomial, 
                 data=survdata,
                 method=&quot;PQL/L&quot;)

Survglm2 &lt;- fitme(SurvieMars ~ 1 + bs(Size0Mars,df=5,degree=3) + bs(age0,degree=3,knots = 6.5)
+ (Size0Mars + age0|year) + (age0|Pop) ,
                 family=binomial, 
                 data=survdata,
                 method=&quot;PQL/L&quot;)

Survglm3 &lt;- fitme(SurvieMars ~ 1 + bs(Size0Mars,df=5,degree=3) + bs(age0,degree=3,knots = c(1.5,6.5)) + (Size0Mars|year) + (age0|Pop) ,
                 family=binomial, 
                 data=survdata,
                 method=&quot;PQL/L&quot;)</code></pre>
<pre><code>## Warning in (function (formula, resid.formula = NULL, data, prior.weights, :
## &#39;c(&#39; detected in formula: did you mean cbind() for binomial response or for
## poly()?</code></pre>
<pre class="r"><code>Survglm4 &lt;- fitme(SurvieMars ~ 1 + bs(Size0Mars,df=5,degree=3) + bs(age0,degree=3,knots = c(1.5,6.5))
+ (Size0Mars + age0|year) + (age0|Pop) ,
                 family=binomial, 
                 data=survdata,
                 method=&quot;PQL/L&quot;)</code></pre>
<pre><code>## Warning in (function (formula, resid.formula = NULL, data, prior.weights, :
## &#39;c(&#39; detected in formula: did you mean cbind() for binomial response or for
## poly()?</code></pre>
<pre class="r"><code>Survglm5 &lt;- fitme(SurvieMars ~ 1 + bs(Size0Mars,df=5,degree=3) + bs(age0,degree=3,knots = 6.5)
+ (Size0Mars|year) + (Size0Mars + age0|Pop) ,
                 family=binomial, 
                 data=survdata,
                 method=&quot;PQL/L&quot;)</code></pre>
<pre class="r"><code>summary(Survglm1)</code></pre>
<pre><code>## formula: SurvieMars ~ 1 + bs(Size0Mars, df = 5, degree = 3) + bs(age0, 
##     degree = 3, knots = 6.5) + (Size0Mars | year) + (age0 | Pop)
## Estimation of ranCoefs by ML (p_v approximation of logL).
## Estimation of fixed effects by h-likelihood approximation.
## family: binomial( link = logit ) 
##  ------------ Fixed effects (beta) ------------
##                                    Estimate Cond. SE t-value
## (Intercept)                         -2.2406   0.2462 -9.1006
## bs(Size0Mars, df = 5, degree = 3)1   0.1103   0.1999  0.5517
## bs(Size0Mars, df = 5, degree = 3)2   0.8657   0.1272  6.8056
## bs(Size0Mars, df = 5, degree = 3)3   4.2121   0.4778  8.8158
## bs(Size0Mars, df = 5, degree = 3)4   3.8150   0.9696  3.9348
## bs(Size0Mars, df = 5, degree = 3)5   3.5933   1.2790  2.8095
## bs(age0, degree = 3, knots = 6.5)1   2.5146   0.2908  8.6480
## bs(age0, degree = 3, knots = 6.5)2  -0.8001   0.5510 -1.4520
## bs(age0, degree = 3, knots = 6.5)3   2.1587   0.6255  3.4513
## bs(age0, degree = 3, knots = 6.5)4   0.1423   0.4088  0.3480
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##          --- Random-coefficients Cov matrices:
##  Group        Term     Var.  Corr.
##   year (Intercept)     1.02       
##   year   Size0Mars  0.01061 -0.672
##    Pop (Intercept)   0.1431       
##    Pop        age0 0.009096  -0.76
## # of obs: 7293; # of groups: year, 27; Pop, 6 
##  ------------- Likelihood values  -------------
##                         logLik
##        h-likelihood: -3345.794
## logL       (p_v(h)): -3347.972</code></pre>
<pre class="r"><code>summary(Survglm2)</code></pre>
<pre><code>## formula: SurvieMars ~ 1 + bs(Size0Mars, df = 5, degree = 3) + bs(age0, 
##     degree = 3, knots = 6.5) + (Size0Mars + age0 | year) + (age0 | 
##     Pop)
## Estimation of ranCoefs by ML (p_v approximation of logL).
## Estimation of fixed effects by h-likelihood approximation.
## family: binomial( link = logit ) 
##  ------------ Fixed effects (beta) ------------
##                                    Estimate Cond. SE t-value
## (Intercept)                        -2.24874   0.2508 -8.9673
## bs(Size0Mars, df = 5, degree = 3)1  0.09729   0.2001  0.4862
## bs(Size0Mars, df = 5, degree = 3)2  0.87965   0.1261  6.9774
## bs(Size0Mars, df = 5, degree = 3)3  4.33060   0.4547  9.5240
## bs(Size0Mars, df = 5, degree = 3)4  3.76265   0.9328  4.0336
## bs(Size0Mars, df = 5, degree = 3)5  3.44384   1.2172  2.8294
## bs(age0, degree = 3, knots = 6.5)1  2.48418   0.3082  8.0608
## bs(age0, degree = 3, knots = 6.5)2 -0.84350   0.5967 -1.4135
## bs(age0, degree = 3, knots = 6.5)3  2.18330   0.7078  3.0848
## bs(age0, degree = 3, knots = 6.5)4  0.06919   0.5440  0.1272
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##          --- Random-coefficients Cov matrices:
##  Group        Term      Var.   Corr. Corr..1
##   year (Intercept)     1.304                
##   year   Size0Mars 0.0005913      -1        
##   year        age0   0.04756  -0.663   0.663
##    Pop (Intercept)    0.1543                
##    Pop        age0   0.01036 -0.7826        
## # of obs: 7293; # of groups: year, 27; Pop, 6 
##  ------------- Likelihood values  -------------
##                         logLik
##        h-likelihood: -3359.315
## logL       (p_v(h)): -3341.086</code></pre>
<pre class="r"><code>summary(Survglm3)</code></pre>
<pre><code>## formula: SurvieMars ~ 1 + bs(Size0Mars, df = 5, degree = 3) + bs(age0, 
##     degree = 3, knots = c(1.5, 6.5)) + (Size0Mars | year) + (age0 | 
##     Pop)
## Estimation of ranCoefs by ML (p_v approximation of logL).
## Estimation of fixed effects by h-likelihood approximation.
## family: binomial( link = logit ) 
##  ------------ Fixed effects (beta) ------------
##                                            Estimate Cond. SE  t-value
## (Intercept)                                -2.23985   0.2463 -9.09280
## bs(Size0Mars, df = 5, degree = 3)1          0.10932   0.1999  0.54682
## bs(Size0Mars, df = 5, degree = 3)2          0.86720   0.1272  6.81565
## bs(Size0Mars, df = 5, degree = 3)3          4.22462   0.4787  8.82432
## bs(Size0Mars, df = 5, degree = 3)4          3.80246   0.9711  3.91554
## bs(Size0Mars, df = 5, degree = 3)5          3.59587   1.2796  2.81021
## bs(age0, degree = 3, knots = c(1.5, 6.5))1  0.01095   0.3491  0.03138
## bs(age0, degree = 3, knots = c(1.5, 6.5))2  2.61115   0.5908  4.41987
## bs(age0, degree = 3, knots = c(1.5, 6.5))3 -0.95676   0.7692 -1.24392
## bs(age0, degree = 3, knots = c(1.5, 6.5))4  2.37011   0.7184  3.29903
## bs(age0, degree = 3, knots = c(1.5, 6.5))5  0.13872   0.4095  0.33875
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##          --- Random-coefficients Cov matrices:
##  Group        Term     Var.   Corr.
##   year (Intercept)    1.021        
##   year   Size0Mars  0.01077 -0.6711
##    Pop (Intercept)   0.1436        
##    Pop        age0 0.009156 -0.7602
## # of obs: 7293; # of groups: year, 27; Pop, 6 
##  ------------- Likelihood values  -------------
##                         logLik
##        h-likelihood: -3345.466
## logL       (p_v(h)): -3347.771</code></pre>
<pre class="r"><code>summary(Survglm4)</code></pre>
<pre><code>## formula: SurvieMars ~ 1 + bs(Size0Mars, df = 5, degree = 3) + bs(age0, 
##     degree = 3, knots = c(1.5, 6.5)) + (Size0Mars + age0 | year) + 
##     (age0 | Pop)
## Estimation of ranCoefs by ML (p_v approximation of logL).
## Estimation of fixed effects by h-likelihood approximation.
## family: binomial( link = logit ) 
##  ------------ Fixed effects (beta) ------------
##                                            Estimate Cond. SE t-value
## (Intercept)                                 -2.2482   0.2508 -8.9626
## bs(Size0Mars, df = 5, degree = 3)1           0.0967   0.2001  0.4833
## bs(Size0Mars, df = 5, degree = 3)2           0.8804   0.1261  6.9830
## bs(Size0Mars, df = 5, degree = 3)3           4.3379   0.4554  9.5250
## bs(Size0Mars, df = 5, degree = 3)4           3.7544   0.9336  4.0213
## bs(Size0Mars, df = 5, degree = 3)5           3.4392   1.2172  2.8256
## bs(age0, degree = 3, knots = c(1.5, 6.5))1   0.1132   0.3500  0.3234
## bs(age0, degree = 3, knots = c(1.5, 6.5))2   2.4172   0.5974  4.0460
## bs(age0, degree = 3, knots = c(1.5, 6.5))3  -0.8176   0.8049 -1.0158
## bs(age0, degree = 3, knots = c(1.5, 6.5))4   2.2926   0.7865  2.9149
## bs(age0, degree = 3, knots = c(1.5, 6.5))5   0.0687   0.5444  0.1262
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##          --- Random-coefficients Cov matrices:
##  Group        Term      Var.   Corr. Corr..1
##   year (Intercept)     1.303                
##   year   Size0Mars 0.0006054      -1        
##   year        age0   0.04765 -0.6614  0.6614
##    Pop (Intercept)    0.1546                
##    Pop        age0   0.01038 -0.7827        
## # of obs: 7293; # of groups: year, 27; Pop, 6 
##  ------------- Likelihood values  -------------
##                         logLik
##        h-likelihood: -3359.220
## logL       (p_v(h)): -3341.027</code></pre>
<pre class="r"><code>summary(Survglm5)</code></pre>
<pre><code>## formula: SurvieMars ~ 1 + bs(Size0Mars, df = 5, degree = 3) + bs(age0, 
##     degree = 3, knots = 6.5) + (Size0Mars | year) + (Size0Mars + 
##     age0 | Pop)
## Estimation of ranCoefs by ML (p_v approximation of logL).
## Estimation of fixed effects by h-likelihood approximation.
## family: binomial( link = logit ) 
##  ------------ Fixed effects (beta) ------------
##                                    Estimate Cond. SE t-value
## (Intercept)                         -2.2250   0.2397 -9.2840
## bs(Size0Mars, df = 5, degree = 3)1   0.1091   0.1999  0.5459
## bs(Size0Mars, df = 5, degree = 3)2   0.8570   0.1278  6.7070
## bs(Size0Mars, df = 5, degree = 3)3   4.1960   0.4967  8.4476
## bs(Size0Mars, df = 5, degree = 3)4   3.9689   1.0148  3.9109
## bs(Size0Mars, df = 5, degree = 3)5   3.6233   1.3663  2.6519
## bs(age0, degree = 3, knots = 6.5)1   2.5437   0.2918  8.7182
## bs(age0, degree = 3, knots = 6.5)2  -0.8567   0.5554 -1.5426
## bs(age0, degree = 3, knots = 6.5)3   2.2147   0.6319  3.5047
## bs(age0, degree = 3, knots = 6.5)4   0.1441   0.4172  0.3455
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##          --- Random-coefficients Cov matrices:
##  Group        Term     Var.   Corr. Corr..1
##   year (Intercept)    1.011                
##   year   Size0Mars  0.01131 -0.6471        
##    Pop (Intercept)   0.1314                
##    Pop   Size0Mars 0.001472   0.353        
##    Pop        age0 0.009911 -0.9029 -0.3149
## # of obs: 7293; # of groups: year, 27; Pop, 6 
##  ------------- Likelihood values  -------------
##                         logLik
##        h-likelihood: -3348.440
## logL       (p_v(h)): -3346.683</code></pre>
<pre class="r"><code>Survpredict1 &lt;- predict(Survglm1, newdata = fake_data)[,1]
Survpredict2 &lt;- predict(Survglm2, newdata = fake_data)[,1]
Survpredict3 &lt;- predict(Survglm3, newdata = fake_data)[,1]
Survpredict4 &lt;- predict(Survglm4, newdata = fake_data)[,1]
Survpredict5 &lt;- predict(Survglm5, newdata = fake_data)[,1]</code></pre>
<pre class="r"><code>plot_survie &lt;- function(data = fake_data, prediction, var, c1, valc1 = 1, c2, valc2 = &quot;Au&quot;, fact) {
  data %&gt;%
    mutate(surv_predi = prediction) %&gt;%
    filter(!!sym(c1) == valc1, !!sym(c2) == valc2) %&gt;%
    ggplot(aes(x = .data[[var]], y = surv_predi)) +
    geom_line(aes(color = as.factor(.data[[fact]]))) +
    theme_minimal() +
    ylim(0, 1)
}</code></pre>
<div id="survie-en-fonction-de-la-taille" class="section level2">
<h2>Survie en fonction de la taille</h2>
<div id="en-fixant-la-population-voir-leffet-année"
class="section level3">
<h3>En fixant la population : voir l’effet année</h3>
<pre class="r"><code>var &lt;- &quot;Size0Mars&quot;
c1 &lt;- &quot;age0&quot;
valc1 &lt;- 1
c2 &lt;- &quot;Pop&quot;
valc2 &lt;- &quot;Au&quot;
fact &lt;- &quot;year&quot;

wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 3
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 8
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
</div>
<div id="en-fixant-lannée-voir-leffet-population"
class="section level3">
<h3>En fixant l’année : voir l’effet population</h3>
<pre class="r"><code>var &lt;- &quot;Size0Mars&quot;
c1 &lt;- &quot;age0&quot;
valc1 &lt;- 1
c2 &lt;- &quot;year&quot;
valc2 &lt;- 2000
fact &lt;- &quot;Pop&quot;

wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 3
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 8
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
</div>
</div>
<div id="survie-en-fonction-de-lage" class="section level2">
<h2>Survie en fonction de l’age</h2>
<div id="en-fixant-la-population-voir-leffet-année-1"
class="section level3">
<h3>En fixant la population : voir l’effet année</h3>
<pre class="r"><code>var &lt;- &quot;age0&quot;
c1 &lt;- &quot;Size0Mars&quot;
valc1 &lt;- 1
c2 &lt;- &quot;Pop&quot;
valc2 &lt;- &quot;Au&quot;
fact &lt;- &quot;year&quot;

wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 5
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 10
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
</div>
<div id="en-fixant-lannée-voir-leffet-population-1"
class="section level3">
<h3>En fixant l’année : voir l’effet population</h3>
<pre class="r"><code>var &lt;- &quot;age0&quot;
c1 &lt;- &quot;Size0Mars&quot;
valc1 &lt;- 1
c2 &lt;- &quot;year&quot;
valc2 &lt;- 2000
fact &lt;- &quot;Pop&quot;

wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 5
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 10
wrap_plots(
plot_survie(prediction = Survpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_survie(prediction = Survpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="nombre-de-capitules" class="section level1">
<h1>Nombre de capitules</h1>
<pre class="r"><code>cptldata &lt;- centauree_data[!is.na(centauree_data$Cptl0),]
cptldata &lt;- cptldata[!cptldata$Flowering0==0,]</code></pre>
<pre class="r"><code># Nombre de capitules moyen / age
cptldata %&gt;% 
  group_by(age0) %&gt;% 
  mutate(meancptl=mean(Cptl0)) %&gt;% 
  
ggplot(aes(x = age0, y = meancptl)) +
  geom_point(color = &quot;red&quot;, size = 2) +
  geom_count(aes(y=Cptl0), alpha=0.6) +
  labs(title = &quot;Relation entre l&#39;age et le nombre de capitules&quot;,
    x = &quot;Age&quot;,
    y = &quot;Nombre de capitules&quot;) +
  theme_minimal()</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code># Nombre de capitule / année 
cptldata %&gt;% 

  ggplot(aes(x=Size0Mars,y=Cptl0))+
    geom_point() +
labs(title = &quot;Relation entre la taille et le nombre de capitules&quot;,
    x = &quot;taille&quot;,
    y = &quot;Nombre de capitules&quot;) +
    theme_minimal()</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<pre class="r"><code>Cptlglm1 &lt;- fitme(Cptl0 ~ 1 + Size0Mars, 
              data=cptldata)

Cptlglm2 &lt;- fitme(Cptl0 ~ 1 + poly(Size0Mars,2), 
              data=cptldata)

Cptlglm3 &lt;- fitme(Cptl0 ~ 1 + poly(Size0Mars,3), 
              data=cptldata)

Cptlglm4 &lt;- fitme(Cptl0 ~ 1 + Size0Mars +(1|year), 
              data=cptldata)

Cptlglm5 &lt;- fitme(Cptl0 ~ 1 + Size0Mars + age0, 
              data=cptldata)</code></pre>
<pre class="r"><code>summary(Cptlglm1)</code></pre>
<pre><code>## formula: Cptl0 ~ 1 + Size0Mars
## ML: Estimation of phi by ML.
##     Estimation of fixed effects by ML.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    2.951   5.6590  0.5214
## Size0Mars      2.074   0.4166  4.9795
##  -------------- Residual variance  ------------
## Coefficients for log(phi)  ~ 1  :
##             Estimate Cond. SE
## (Intercept)    5.786   0.1451
## Estimate of phi=residual var:  325.6 
##  ------------- Likelihood values  -------------
##                         logLik
## logL               : -409.6181</code></pre>
<pre class="r"><code>summary(Cptlglm2)</code></pre>
<pre><code>## formula: Cptl0 ~ 1 + poly(Size0Mars, 2)
## ML: Estimation of phi by ML.
##     Estimation of fixed effects by ML.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##                     Estimate Cond. SE t-value
## (Intercept)            29.58    1.836  16.108
## poly(Size0Mars, 2)1    89.85   17.898   5.020
## poly(Size0Mars, 2)2    22.36   17.898   1.249
##  -------------- Residual variance  ------------
## Coefficients for log(phi)  ~ 1  :
##             Estimate Cond. SE
## (Intercept)    5.769   0.1451
## Estimate of phi=residual var:  320.3 
##  ------------- Likelihood values  -------------
##                         logLik
## logL               : -408.8444</code></pre>
<pre class="r"><code>summary(Cptlglm3)</code></pre>
<pre><code>## formula: Cptl0 ~ 1 + poly(Size0Mars, 3)
## ML: Estimation of phi by ML.
##     Estimation of fixed effects by ML.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##                     Estimate Cond. SE t-value
## (Intercept)            29.58    1.825  16.210
## poly(Size0Mars, 3)1    89.85   17.785   5.052
## poly(Size0Mars, 3)2    22.36   17.785   1.257
## poly(Size0Mars, 3)3   -19.56   17.785  -1.100
##  -------------- Residual variance  ------------
## Coefficients for log(phi)  ~ 1  :
##             Estimate Cond. SE
## (Intercept)    5.757   0.1451
## Estimate of phi=residual var:  316.3 
##  ------------- Likelihood values  -------------
##                         logLik
## logL               : -408.2434</code></pre>
<pre class="r"><code>summary(Cptlglm4)</code></pre>
<pre><code>## formula: Cptl0 ~ 1 + Size0Mars + (1 | year)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    4.198   5.9466  0.7059
## Size0Mars      2.010   0.4253  4.7263
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    year  :  19.26  
## # of obs: 95; # of groups: year, 16 
##  -------------- Residual variance  ------------
## phi estimate was 308.566 
##  ------------- Likelihood values  -------------
##                         logLik
## logL       (p_v(h)): -409.4104</code></pre>
<pre class="r"><code>summary(Cptlglm5)</code></pre>
<pre><code>## formula: Cptl0 ~ 1 + Size0Mars + age0
## ML: Estimation of phi by ML.
##     Estimation of fixed effects by ML.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)   0.9787   9.3256  0.1049
## Size0Mars     2.0965   0.4246  4.9372
## age0          0.3645   1.3705  0.2660
##  -------------- Residual variance  ------------
## Coefficients for log(phi)  ~ 1  :
##             Estimate Cond. SE
## (Intercept)    5.785   0.1451
## Estimate of phi=residual var:  325.4 
##  ------------- Likelihood values  -------------
##                         logLik
## logL               : -409.5828</code></pre>
<pre class="r"><code>Cptlpredict1 &lt;- predict(Cptlglm1, newdata = fake_data)[,1]
Cptlpredict2 &lt;- predict(Cptlglm2, newdata = fake_data)[,1]
Cptlpredict3 &lt;- predict(Cptlglm3, newdata = fake_data)[,1]
Cptlpredict4 &lt;- predict(Cptlglm4, newdata = fake_data)[,1]
Cptlpredict5 &lt;- predict(Cptlglm5, newdata = fake_data)[,1]</code></pre>
<pre class="r"><code>plot_capitule &lt;- function(data = fake_data, prediction, var, c1, valc1 = 1, c2, valc2 = &quot;Au&quot;, fact) {
  data %&gt;%
    mutate(cptl_predi = prediction) %&gt;%
    filter(!!sym(c1) == valc1, !!sym(c2) == valc2) %&gt;%
    ggplot(aes(x = .data[[var]], y = cptl_predi)) +
    geom_line(aes(color = as.factor(.data[[fact]]))) +
    theme_minimal() +
    ylim(0,50)
  }</code></pre>
<div id="nombre-de-capitules-en-fonction-de-la-taille"
class="section level2">
<h2>Nombre de capitules en fonction de la taille</h2>
<div id="en-fixant-la-population-voir-leffet-année-2"
class="section level3">
<h3>En fixant la population : voir l’effet année</h3>
<pre class="r"><code>var &lt;- &quot;Size0Mars&quot;
c1 &lt;- &quot;age0&quot;
valc1 &lt;- 1
c2 &lt;- &quot;Pop&quot;
valc2 &lt;- &quot;Au&quot;
fact &lt;- &quot;year&quot;

wrap_plots(
plot_capitule(prediction = Cptlpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 3
wrap_plots(
plot_capitule(prediction = Cptlpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
</div>
</div>
<div id="nombre-de-capitules-en-fonction-de-lage"
class="section level2">
<h2>Nombre de capitules en fonction de l’age</h2>
<div id="en-fixant-la-population-voir-leffet-année-3"
class="section level3">
<h3>En fixant la population : voir l’effet année</h3>
<pre class="r"><code>var &lt;- &quot;age0&quot;
c1 &lt;- &quot;Size0Mars&quot;
valc1 &lt;- 1
c2 &lt;- &quot;Pop&quot;
valc2 &lt;- &quot;Au&quot;
fact &lt;- &quot;year&quot;

wrap_plots(
plot_capitule(prediction = Cptlpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 5
wrap_plots(
plot_capitule(prediction = Cptlpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<pre class="r"><code>valc1 &lt;- 10
wrap_plots(
plot_capitule(prediction = Cptlpredict1, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict2, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict3, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict4, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact),
plot_capitule(prediction = Cptlpredict5, var=var, c1=c1, valc1=valc1, c2=c2, valc2=valc2, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="taille-des-plantules" class="section level1">
<h1>Taille des plantules</h1>
<pre class="r"><code>plantule_data &lt;- centauree_data_complet[centauree_data_complet$age0==1,]</code></pre>
<pre class="r"><code># Taille des plantules / année

plantule_data %&gt;% 
ggplot(aes(x = year, y = Size0Mars)) +
  geom_count(alpha=0.6) +
  labs(x = &quot;Année&quot;,
    y = &quot;Taille des plantules&quot;) +
  theme_minimal()</code></pre>
<pre><code>## Warning: Removed 2360 rows containing non-finite outside the scale range
## (`stat_sum()`).</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code># Taille des plantules / population

plantule_data %&gt;% 
ggplot(aes(x = Pop, y = Size0Mars)) +
  geom_count(alpha=0.6) +
  labs(x = &quot;Population&quot;,
    y = &quot;Taille des plantules&quot;) +
  theme_minimal()</code></pre>
<pre><code>## Warning: Removed 2360 rows containing non-finite outside the scale range
## (`stat_sum()`).</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<pre class="r"><code>Pltglm1 &lt;- fitme(Size0Mars ~ 1 + (1|year) + (1|Pop) + (1|Pop:year), 
              data=plantule_data)

Pltglm2 &lt;- fitme(Size0Mars ~ 1 + (1|Pop) + (1|Pop:year), 
              data=plantule_data)

Pltglm3 &lt;- fitme(Size0Mars ~ 1 + (1|Pop:year), 
              data=plantule_data)

Pltglm4 &lt;- fitme(Size0Mars ~ 1 + (1|year) + (1|Pop:year), 
              data=plantule_data)

Pltglm5 &lt;- fitme(Size0Mars ~ 1 + (1|year) + (1|Pop), 
              data=plantule_data)</code></pre>
<pre class="r"><code>summary(Pltglm1)</code></pre>
<pre><code>## formula: Size0Mars ~ 1 + (1 | year) + (1 | Pop) + (1 | Pop:year)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    1.382   0.1267   10.91
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    year  :  0.03363 
##    Pop  :  0.06829 
##    Pop:year  :  0.3535  
## # of obs: 4648; # of groups: year, 26; Pop, 6; Pop:year, 136 
##  -------------- Residual variance  ------------
## phi estimate was 0.688727 
##  ------------- Likelihood values  -------------
##                         logLik
## logL       (p_v(h)): -5891.028</code></pre>
<pre class="r"><code>summary(Pltglm2)</code></pre>
<pre><code>## formula: Size0Mars ~ 1 + (1 | Pop) + (1 | Pop:year)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    1.374   0.1213   11.32
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    Pop  :  0.06649 
##    Pop:year  :  0.3966  
## # of obs: 4648; # of groups: Pop, 6; Pop:year, 136 
##  -------------- Residual variance  ------------
## phi estimate was 0.688347 
##  ------------- Likelihood values  -------------
##                        logLik
## logL       (p_v(h)): -5891.66</code></pre>
<pre class="r"><code>summary(Pltglm3)</code></pre>
<pre><code>## formula: Size0Mars ~ 1 + (1 | Pop:year)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    1.354  0.06375   21.24
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    Pop:year  :  0.4668  
## # of obs: 4648; # of groups: Pop:year, 136 
##  -------------- Residual variance  ------------
## phi estimate was 0.688088 
##  ------------- Likelihood values  -------------
##                         logLik
## logL       (p_v(h)): -5895.849</code></pre>
<pre class="r"><code>summary(Pltglm4)</code></pre>
<pre><code>## formula: Size0Mars ~ 1 + (1 | year) + (1 | Pop:year)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    1.357  0.06779   20.01
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    year  :  0.01713 
##    Pop:year  :  0.4463  
## # of obs: 4648; # of groups: year, 26; Pop:year, 136 
##  -------------- Residual variance  ------------
## phi estimate was 0.688217 
##  ------------- Likelihood values  -------------
##                         logLik
## logL       (p_v(h)): -5895.717</code></pre>
<pre class="r"><code>summary(Pltglm5)</code></pre>
<pre><code>## formula: Size0Mars ~ 1 + (1 | year) + (1 | Pop)
## Estimation of fixed effects by ML.
## Estimation of lambda and phi by &#39;outer&#39; ML, maximizing logL.
## family: gaussian( link = identity ) 
##  ------------ Fixed effects (beta) ------------
##             Estimate Cond. SE t-value
## (Intercept)    1.357   0.1032   13.14
##  --------------- Random effects ---------------
## Family: gaussian( link = identity ) 
##            --- Variance parameters (&#39;lambda&#39;):
## lambda = var(u) for u ~ Gaussian; 
##    year  :  0.08524 
##    Pop  :  0.04151  
## # of obs: 4648; # of groups: year, 26; Pop, 6 
##  -------------- Residual variance  ------------
## phi estimate was 0.77653 
##  ------------- Likelihood values  -------------
##                         logLik
## logL       (p_v(h)): -6050.509</code></pre>
<pre class="r"><code>Pltpredict1 &lt;- predict(Pltglm1, newdata = fake_data)[,1]
Pltpredict2 &lt;- predict(Pltglm2, newdata = fake_data)[,1]
Pltpredict3 &lt;- predict(Pltglm3, newdata = fake_data)[,1]
Pltpredict4 &lt;- predict(Pltglm4, newdata = fake_data)[,1]
Pltpredict5 &lt;- predict(Pltglm5, newdata = fake_data)[,1]</code></pre>
<pre class="r"><code>plot_plantule &lt;- function(data = fake_data, prediction, var, fact) {
  data %&gt;%
    mutate(plt_predi = prediction) %&gt;%
    ggplot(aes(x = .data[[var]], y = plt_predi)) +
    geom_line(aes(color = as.factor(.data[[fact]]))) +
    theme_minimal()
}

plot_plantule2 &lt;- function(data = fake_data, prediction, var, fact) {
  data %&gt;%
    mutate(plt_predi = prediction) %&gt;%
    ggplot(aes(x = .data[[var]], y = plt_predi),alpha=0.6) +
    geom_point(aes(color = as.factor(.data[[fact]]))) +
    theme_minimal()
}</code></pre>
<div id="taille-des-plantules-en-fonction-de-lannée"
class="section level2">
<h2>Taille des plantules en fonction de l’année</h2>
<pre class="r"><code>var &lt;- &quot;year&quot;
fact &lt;- &quot;Pop&quot;

wrap_plots(
plot_plantule(prediction = Pltpredict1, var=var, fact=fact),
plot_plantule(prediction = Pltpredict2, var=var, fact=fact),
plot_plantule(prediction = Pltpredict3, var=var, fact=fact),
plot_plantule(prediction = Pltpredict4, var=var, fact=fact),
plot_plantule(prediction = Pltpredict5, var=var, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="taille-des-plantules-en-fonction-de-la-population"
class="section level2">
<h2>Taille des plantules en fonction de la population</h2>
<pre class="r"><code>var &lt;- &quot;Pop&quot;
fact &lt;- &quot;year&quot;

wrap_plots(
plot_plantule2(prediction = Pltpredict1, var=var, fact=fact),
plot_plantule2(prediction = Pltpredict2, var=var, fact=fact),
plot_plantule2(prediction = Pltpredict3, var=var, fact=fact),
plot_plantule2(prediction = Pltpredict4, var=var, fact=fact),
plot_plantule2(prediction = Pltpredict5, var=var, fact=fact)
)</code></pre>
<p><img src="ModelFitted_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="establishment-rate" class="section level1">
<h1>Establishment rate</h1>
<pre class="r"><code>Estb &lt;- list()
for (i in unique(centauree_data_complet$year)){}</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
