geom_line(aes(y = floweringProba), color = "red") +
labs(title = "Relation entre la floraison et l'age",
x = "age",
y = "Floraison",
subtitles = "Points gris: floraison réelle des individus (0 ou 1)
Points rouge: floraison moyenne par classe d'age") +
ylim(0, 1) +
theme_minimal()
plantule_data <- centauree_data[centauree_data$Age==1,]
# Taille des plantules / année
plantule_data %>%
ggplot(aes(x = year, y = Size0Mars)) +
geom_count(alpha=0.6) +
labs(title = "Distribution des tailles de plantules selon les années",
x = "Année",
y = "Taille des plantules") +
theme_minimal()
# Taille des plantules / population
plantule_data %>%
ggplot(aes(x = Pop, y = Size0Mars)) +
geom_count(alpha=0.6) +
labs(title = "Distribution des tailles de plantules selon les populations",
x = "Population",
y = "Taille des plantules") +
theme_minimal()
plantule_data %>%
ggplot(aes(x=Size0Mars))+
geom_histogram()+
xlim(0,8)
growthdata <- centauree_data[!is.na(centauree_data$Size1Mars), ]
growthdata <- growthdata[growthdata$Size1Mars != 0, ]
growthdata %>%
ggplot(aes(y = Size1Mars, x = Size0Mars)) +
geom_count(alpha=0.5) +
labs(title = "Relation entre la taille à l'année suivante et la taille à l'année actuelle",
y = "Taille à t+1",
x = "Taille à t") +
theme_minimal()
growthdata %>%
ggplot(aes(y = log(Size1Mars), x = Size0Mars)) +
geom_count(alpha=0.5) +
labs(title = "Relation log-log entre la taille à l'année suivante et la taille à l'année actuelle",
y = "log Taille à t+1",
x = "Taille à t") +
theme_minimal()
growthdata %>%
ggplot(aes(y = (sqrt(Size1Mars)-1)/0.5, x = Size0Mars)) +
geom_count(alpha=0.5) +
labs(title = "Relation entre la taille à l'année suivante et la taille à l'année actuelle",
y = "racine Taille à t+1",
x = "Taille à t") +
theme_minimal()
growthdata %>%
ggplot(aes(y = sqrt(Size1Mars), x = Size0Mars)) +
geom_count(alpha=0.5) +
labs(title = "Relation entre la taille à l'année suivante et la taille à l'année actuelle",
y = "racine Taille à t+1",
x = "Taille à t") +
theme_minimal()
cptldata <- IPM_data[!is.na(centauree_data$Capitule),]
cptldata <- cptldata[!cptldata$Flowering==0,]
# Nombre de capitule / taille
cptldata %>%
ggplot(aes(x=Size0Mars,y=Capitule))+
geom_point() +
labs(title = "Relation entre le nombre de capitules et la taille",
x = "Taille",
y = "Nombre de capitules") +
theme_minimal()
# Nombre de capitule / année
cptldata %>%
ggplot(aes(x=year,y=Capitule))+
geom_point() +
labs(title = "Relation entre le nombre de capitules et l'année",
x = "Année",
y = "Nombre de capitules") +
theme_minimal()
cptldata %>%
group_by(year) %>%
mutate(nbc = sum(Capitule)) %>%
ggplot(aes(x=year,y=nbc))+
geom_point() +
labs(title = "Relation entre le nombre de capitules et l'année",
x = "Année",
y = "Nombre de capitules") +
theme_minimal()
cptldata %>%
group_by(year) %>%
mutate(nbrflor = sum(Flowering)) %>%
ggplot(aes(x = year, y = nbrflor)) +
geom_vline(aes(xintercept = 2002.5)) +
geom_vline(aes(xintercept = 2011.5)) +
geom_point(size = 2) +
labs(title = "Relation entre le nombre de capitules et l'année", x = "Année", y = "Nombre de capitules") +
theme_minimal() +
xlim(1998, 2022) +
ylim(0, 28)
centauree_data %>%
group_by(year) %>%
mutate(nbrflor = sum(Flowering)) %>%
ggplot(aes(x = year, y = nbrflor)) +
geom_vline(aes(xintercept = 2002.5)) +
geom_vline(aes(xintercept = 2011.5)) +
geom_point(size = 2) +
labs(title = "Relation entre le nombre de capitules et l'année", x = "Année", y = "Nombre de capitules") +
theme_minimal() +
xlim(1998, 2022) +
ylim(0, 28)
load("IPM/ModelsAIC")
summary(Survglm11)
summary(Survglm12)
summary(Flowglm1)
summary(Pltglm1)
summary(Cptlglm1)
summary(Growthglm2)
Survpredict11 <- predict(Survglm11, newdata = fake_data1)[,1]
Survpredict12 <- predict(Survglm12, newdata = fake_data2)[,1]
Flowpredict1 <- predict(Flowglm1, newdata = fake_data)[,1]
Pltpredict1 <- predict(Pltglm1, newdata = fake_data)[,1]
Cptlpredict1 <- predict(Cptlglm1, newdata = fake_data)[,1]
Growthpredict1 <- predict(Growthglm1, newdata = fake_data)[,1]
Growthpredict2 <- predict(Growthglm2, newdata = fake_data)[,1]
#Survie plantules
resSurv1 <- get_respVar(Survglm11,newdata = fake_data1)
fake_data1 %>%
mutate(surv = Survpredict11)%>%
group_by(Size0Mars,year) %>%
mutate(surv_predi = mean(surv, na.rm = TRUE),
.group="drop") %>%
ggplot(aes(x = Size0Mars, y = surv_predi)) +
geom_count(data=survdata1,aes(x=Size0Mars,y=Survie),alpha = 0.5) +
geom_line(aes(color=as.factor(year)),show.legend = FALSE) +
theme_bw()+
ylim(0, 1) +
xlim(0,15)+
labs(x = "Size",
y = "Survival probability")+
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
fake_data1 %>%
mutate(surv = Survpredict11)%>%
group_by(Size0Mars,year) %>%
mutate(surv_predi = mean(surv, na.rm = TRUE),
.group="drop") %>%
ggplot(aes(x = Size0Mars, y = surv_predi)) +
geom_count(data=survdata1,aes(x=Size0Mars,y=Survie),alpha = 0.5) +
geom_line(aes(color=as.factor(year)),show.legend = FALSE) +
theme_bw()+
ylim(0, 1) +
xlim(0,15)+
labs(x = "Size",
y = "Survival probability")+
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
#Survie rosettes
fake_data2 %>%
mutate(surv = Survpredict12) %>%
filter(Age==c(2,8)) %>%
group_by(Size0Mars,Pop,Age) %>%
mutate(surv_predi = mean(surv),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = surv_predi)) +
facet_wrap(~Age, labeller = as_labeller(c('2'="age 2",'8'="age 8")))+
geom_count(data=survdata2[survdata2$Age %in% c(2,8),],aes(x=Size0Mars,y=Survie),alpha = 0.3) +
geom_line(aes(color = as.factor(Pop)),show.legend = FALSE) +
theme_bw()+
ylim(0, 1) +
labs(x = "Size",
y = "Survival probability",
color = "Population")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)+
scale_color_viridis_d(option = "plasma")
fake_data2 %>%
mutate(surv = Survpredict12) %>%
filter(Age==c(2,8)) %>%
group_by(Size0Mars,year,Age) %>%
mutate(surv_predi = mean(surv),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = surv_predi)) +
facet_wrap(~Age, labeller = as_labeller(c('2'="age 2",'8'="age 8")))+
geom_count(data=survdata2[survdata2$Age %in% c(2,8),],aes(x=Size0Mars,y=Survie),alpha = 0.3) +
geom_line(aes(color = as.factor(year)),show.legend = FALSE) +
theme_bw()+
ylim(0, 1) +
labs(x = "Size",
y = "Survival probability",
color = "Year")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
Pop
population
populations
fake_data2 %>%
mutate(surv = Survpredict12) %>%
filter(Age==c(2,8)) %>%
group_by(Size0Mars,Pop,Age) %>%
mutate(surv_predi = mean(surv),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = surv_predi)) +
facet_wrap(~Age, labeller = as_labeller(c('2'="age 2",'8'="age 8")))+
geom_count(data=survdata2[survdata2$Age %in% c(2,8),],aes(x=Size0Mars,y=Survie),alpha = 0.3) +
geom_line(aes(color = as.factor(Pop))) +
theme_bw()+
ylim(0, 1) +
labs(x = "Size",
y = "Survival probability",
color = "Population")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)+
scale_color_viridis_d(option = "plasma")
# #Floraison
# resFlow <- get_predVar(Flowglm1,newdata = fake_data)
#   geom_ribbon(aes(ymin = flow_predi-resVar, ymax = flow_predi+resVar, alpha=0.08,fill=as.factor(Age)))+
fake_data %>%
mutate(flow_predi = Flowpredict1) %>%
group_by(Size0Mars, Age) %>%
summarise(flow_predi = mean(flow_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = flow_predi)) +
geom_count(data=centauree_data,aes(x=Size0Mars,y=Flowering,col=as.factor(Age)),alpha = 0.6,show.legend = FALSE) +
geom_line(aes(color = as.factor(Age)),size=0.75) +
theme_bw()+
ylim(0, 1) +
labs(x = "Size",
y = "Flowering probability",
color = "Age")+
scale_color_brewer(palette = "Spectral", direction = -1) +
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
fake_data %>%
mutate(flow_predi = Flowpredict1)%>%
filter(Age==c(2,4,8)) %>%
group_by(Size0Mars, Pop, Age) %>%
summarise(flow_predi = mean(flow_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = flow_predi)) +
facet_wrap(vars(Age), labeller = as_labeller(c('2'="age2",'4'="age4",'8'="age8")))+
geom_line(aes(color = as.factor(Pop))) +
theme_bw()+
ylim(0, 1) +
labs(x = "Size",
y = "Flowering probability",
fill = "Populations",
color = "Populations")
#Croissance
fake_data %>%
mutate(s1_predi = Growthpredict2) %>%
group_by(Size0Mars, Age) %>%
summarise(s1_predi = mean(s1_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = s1_predi)) +
geom_count(data=growthdata,aes(x=Size0Mars,y=Size1Mars,colour = as.factor(Age)),alpha = 0.5,show.legend = FALSE) +
geom_abline(lty="dashed")+
geom_line(aes(color = as.factor(Age)),size=0.7) +
theme_bw()+
labs(x = "Size(t)",
y = "Size(t+1)",
fill = "Age",
color = "Age")+
scale_color_brewer(palette = "Spectral", direction = -1) +
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
fake_data %>%
mutate(s1_predi = Growthpredict2) %>%
filter(Age==c(1,4,8)) %>%
group_by(Size0Mars, year, Age) %>%
mutate(s1_predi = mean(s1_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = s1_predi)) +
facet_wrap(vars(Age), labeller = as_labeller(c('1'="age 1",'4'="age 4",'8'="age 8")),scales="free_x")+
geom_line(aes(color = as.factor(year)),show.legend = FALSE) +
geom_abline(lty="dashed")+
theme_bw()+
labs(x = "Size(t)",
y = "Size(t+1)",
fill = "Year",
color = "Year")+
theme(legend.text = element_text(size = 4),
legend.key.size = unit(0.4, "cm"),
legend.title = element_text(size = 8))
fake_data %>% mutate(sdgrow = exp(1.1013346+0.5553254*log(Size0Mars)-0.1231723*log(Age))) %>%
group_by(Size0Mars, Age) %>%
summarise(sd_predi = mean(sdgrow),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = sd_predi)) +
geom_line(aes(color = as.factor(Age))) +
theme_bw()+
labs(x = "Size(t)",
y = "Growth residual variance",
fill = "Age",
color = "Age")+
scale_color_brewer(palette = "Spectral", direction = -1) +
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 13),   # Taille des graduations axe X
axis.text.y = element_text(size = 13)    # Taille des graduations axe Y
)
fake_data %>%
mutate(s1_predi = Growthpredict2) %>%
group_by(Size0Mars, Pop) %>%
summarise(s1_predi = mean(s1_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = s1_predi)) +
# geom_count(data=growthdata,aes(x=Size0Mars,y=Size1Mars,colour = as.factor(Pop)),alpha = 0.5,show.legend = FALSE) +
geom_abline(lty="dashed")+
geom_line(aes(color = as.factor(Pop)),size=0.7) +
theme_bw()+
labs(x = "Size(t)",
y = "Size(t+1)",
fill = "Pop",
color = "Pop")+
scale_color_viridis_d(option = "plasma")+
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
#Fécondité
fake_data %>%
mutate(cptl_predi = exp(Cptlpredict1)) %>%
group_by(Size0Mars,year) %>%
summarise(cptl_predi = mean(cptl_predi)) %>%
ggplot(aes(x = Size0Mars, y = cptl_predi)) +
geom_point(data = cptldata, aes(y = Capitule), alpha = 0.6) +
geom_line(aes(color=as.factor(year)),show.legend=FALSE) +
theme_bw()+
labs(x = "Size",
y = "Number of capitula")+
ylim(0,100)+
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
fake_data %>%
mutate(cptl_predi = exp(Cptlpredict1)) %>%
group_by(Age,year) %>%
summarise(cptl_predi = mean(cptl_predi)) %>%
ggplot(aes(x = Age, y = cptl_predi)) +
geom_point(data = cptldata, aes(y = Capitule), alpha = 0.6) +
geom_line(aes(color=as.factor(year)),show.legend=FALSE) +
theme_bw()+
labs(x = "Age",
y = "Number of capitula")+
ylim(0,100)+
xlim(1,8)+
theme(
axis.title.x = element_text(size = 16),  # Taille du titre axe X
axis.title.y = element_text(size = 16),  # Taille du titre axe Y
axis.text.x = element_text(size = 14),   # Taille des graduations axe X
axis.text.y = element_text(size = 14)    # Taille des graduations axe Y
)
fake_data %>%
mutate(s1_predi = Growthpredict2,
flow_predi = Flowpredict1) %>%
group_by(Size0Mars) %>%
mutate(flow_predi = mean(flow_predi)) %>%
group_by(Size0Mars, Age) %>%
mutate(s1_predi = mean(s1_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = s1_predi)) +
geom_abline(lty="dashed")+
geom_line(aes(y = 17.5*flow_predi),color="red") +
scale_y_continuous("Size(t+1)",
sec.axis = sec_axis(~ . /17.5, name = "Flowering Probability"))+
geom_line(aes(color = as.factor(Age))) +
theme_bw()+
labs(title = "Croissance prédite (log-log)",
subtitle = "Chaque courbe représente un age, une moyenne a été faite sur les années et les populations",
x = "Size(t)",
y = "Size(t+1)",
fill = "Ages",
color = "Ages")
fake_data %>%
mutate(s1_predi = Growthpredict2,
flow_predi = Flowpredict1) %>%
group_by(Size0Mars, Age) %>%
mutate(s1_predi = mean(s1_predi),
flow_predi = mean(flow_predi),
.groups = "drop") %>%
ggplot(aes(x = Size0Mars, y = s1_predi)) +
geom_abline(lty="dashed")+
geom_line(aes(y = 17.5*flow_predi, color = as.factor(Age))) +
scale_y_continuous("Size(t+1)",
sec.axis = sec_axis(~ . /17.5, name = "Flowering Probability"))+
geom_line(aes(color = as.factor(Age))) +
theme_bw()+
labs(title = "Croissance prédite (log-log)",
subtitle = "Chaque courbe représente un age, une moyenne a été faite sur les années et les populations",
x = "Size(t)",
y = "Size(t+1)",
fill = "Ages",
color = "Ages")
#Survie rosettes
# resSurv2 <- residVar(Survglm12,newdata = fake_data2)
sdata <- survdata2
fake_data2 %>%
mutate(surv = Survpredict12)%>%
group_by(Age,Pop) %>%
summarise(surv_predi = mean(surv),
.groups = "drop") %>%
ggplot(aes(x = Age, y = surv_predi)) +
geom_count(data=survdata2,aes(x=Age,y=Survie),alpha = 0.5) +
geom_line(aes(color = as.factor(Pop)))+
theme_bw() +
ylim(0, 1) +
labs( x = "Age",
y = "Survival probability",
fill = "Population",
color = "Population")+
scale_color_viridis_d(option = "plasma")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 13),   # Taille des graduations axe X
axis.text.y = element_text(size = 13)    # Taille des graduations axe Y
)
fake_data2 %>%
mutate(surv = Survpredict12)%>%
group_by(Age,year) %>%
summarise(surv_predi = mean(surv),
.groups = "drop") %>%
ggplot(aes(x = Age, y = surv_predi)) +
geom_count(data=survdata2,aes(x=Age,y=Survie),alpha = 0.5) +
geom_line(aes(color = as.factor(year)),show.legend = FALSE)+
theme_bw() +
ylim(0, 1) +
labs( x = "Age",
y = "Survival probability",
fill = "Year",
color = "Year")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 13),   # Taille des graduations axe X
axis.text.y = element_text(size = 13)    # Taille des graduations axe Y
)
#Floraison
resFlow <- residVar(Flowglm1,newdata = fake_data)
fake_data %>%
mutate(flow_predi = Flowpredict1) %>%
group_by(Pop, Age) %>%
summarise(flow_predi = mean(flow_predi),
.groups = "drop") %>%
ggplot(aes(x = Age, y = flow_predi)) +
geom_line(aes(color = as.factor(Pop))) +
theme_bw() +
ylim(0, 1) +
labs(x = "Age",
y = "Flowering probability",
fill = "Populations",
color = "Populations")+
scale_color_viridis_d(option = "plasma")+
theme(
axis.title.x = element_text(size = 15),  # Taille du titre axe X
axis.title.y = element_text(size = 15),  # Taille du titre axe Y
axis.text.x = element_text(size = 13),   # Taille des graduations axe X
axis.text.y = element_text(size = 13)    # Taille des graduations axe Y
)
fake_data %>%
mutate(plt_predi = Pltpredict1) %>%
group_by(Pop) %>%
mutate(mean=mean(plt_predi)))
mutate(mean=mean(plt_predi))
fake_data %>%
mutate(plt_predi = Pltpredict1) %>%
group_by(Pop) %>%
mutate(mean=mean(plt_predi))
fake_data %>%
mutate(plt_predi = Pltpredict1) %>%
group_by(Pop,Size0Mars,Age) %>%
mutate(mean=mean(plt_predi))
fake_data %>%
mutate(plt_predi = Pltpredict1) %>%
group_by(Pop,Size0Mars,Age,year) %>%
mutate(mean=mean(plt_predi))
fake_data %>%
mutate(plt_predi = Pltpredict1) %>%
group_by(Size0Mars,Age,year) %>%
mutate(mean=mean(plt_predi))
